{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Datos</title>
    <link rel="stylesheet" href="{% static 'css/datos.css' %}" />
      <link rel="stylesheet" href="{% static 'css/responsive datos.css' %}">
</head>
<body>

     <header class="header-movil">
    <div class="hamburger" onclick="toggleMenu()">☰</div>
    <h1 class="titulo-movil">Datos Sensores</h1>
    <img src="{% static 'image/logo_empresa.png' %}" alt="Logo" class="logo-movil">
  </header>

<nav class="barra-navegacion-superior">
    <img src="/static/image/logo_empresa.png" alt="Logo de la Empresa" class="logo" />
    <ul class="enlaces-nav">
        <li><a href="{% url 'historial' %}?id={{ request.GET.id }}" class="{% if request.path == '/index/login/historial/' %}activo{% endif %}">Historial</a></li>
        <li><a href="{% url 'datos' %}?id={{ request.GET.id }}" class="{% if request.path == '/index/login/datos/' %}activo{% endif %}">Datos</a></li>
        <li><a href="{% url 'recomendaciones' %}?id={{ request.GET.id }}" class="{% if request.path == '/index/login/recomendaciones/' %}activo{% endif %}">Sugerencias</a></li>
    </ul>
</nav>

   <!-- Menú desplegable móvil -->
    <div id="mobileMenu" class="mobile-menu">
        <a href="{% url 'historial' %}?id={{ request.GET.id }}">Historial</a>
        <a href="{% url 'datos' %}?id={{ request.GET.id }}">Datos</a>
        <a href="{% url 'recomendaciones' %}?id={{ request.GET.id }}">Sugerencias</a>
        <a href="{% url 'login' %}" class="btn-cerrar">Cerrar sesión</a>
    </div>


<div class="contenedor">
    <h2><center>Información De Los Sensores</center></h2>
    <h4><center>
        En esta sección se presentan los últimos 30 registros del mes, <br />
        con datos detallados sobre la humedad, temperatura y nivel de pH. <br />
        Esta información es clave para el análisis y monitoreo de las condiciones ambientales del cultivo.
    </center></h4>

    <div class="tabla-actions-bottom" style="width:90%; max-width:1000px; margin:10px 0;">
            <button id="download-pdf-btn" class="btn-download-pdf" title="Descargar PDF">
                <img class="icono-pdf" src="{% static 'image/pdf.png' %}" alt="">
                Descargar PDF
            </button>
        </div>

    <div class="tabla-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Humedad (%)</th>
                    <th>Temperatura (°C)</th>
                    <th>pH</th>
                </tr>
            </thead>
            <tbody id="tabla-cuerpo">
                <tr><td colspan="4">Cargando datos...</td></tr>
            </tbody>
        </table>
    </div>
</div>
        

<div class="cerrar-sesion">
    <a href="{% url 'login' %}">Cerrar sesión</a>
</div>

<script>
  const fincaId = "{{ finca_id }}";
  let urlDatosApi = null;
  if (fincaId && fincaId !== 'None') {
    urlDatosApi = `/index/login/datos_json/?id=${fincaId}`;
  }
</script>
<script src="{% static 'javascript/datos.js' %}"></script>
 <script src="{% static 'javascript/responsive mobil.js' %}"></script>
        <!-- jsPDF y autoTable (CDN) -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="{% static 'javascript/datos_pdf.js' %}"></script>
</body>
</html>
